<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Job Search Results</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body,
      html {
        font-family: "Poppins", Arial, sans-serif;
        background: linear-gradient(135deg, #f6f9fc 0%, #e9f2f9 100%);
        margin: 0;
        padding: 0;
        overflow-x: hidden;
      }

      .parallax-container {
        perspective: 1px;
        height: 100vh;
        overflow-x: hidden;
        overflow-y: auto;
      }
      .parallax-layer {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
      }
      .parallax-background {
        transform: translateZ(-1px) scale(2);
        background: url("https://source.unsplash.com/random/1920x1080?abstract")
          no-repeat center center fixed;
        background-size: cover;
        z-index: -1;
      }
      .content {
        transform: translateZ(0);
        position: relative;
        background-color: rgba(255, 255, 255, 0.9);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        border-radius: 15px;
        margin: 20px auto;
        padding: 40px;
        max-width: 1200px;
      }
      h1 {
        text-align: center;
        font-size: 3em;
        color: #333;
        margin-bottom: 40px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        animation: slideDown 1s ease-out;
      }
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-50px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .job-card {
        background-color: #fff;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        margin-bottom: 30px;
        padding: 30px;
        display: flex;
        flex-direction: row;
        align-items: center;
        transition: all 0.3s ease;
        animation: slideIn 0.5s ease-out forwards;
        opacity: 0;
        transform: translateX(-50px);
      }
      @keyframes slideIn {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      .job-card:hover {
        transform: translateY(-5px) scale(1.02);
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
      }
      .job-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid #e0e0e0;
        padding-bottom: 20px;
        margin-bottom: 20px;
      }
      .job-title {
        font-size: 1.8em;
        font-weight: 600;
        color: #2c3e50;
        transition: color 0.3s ease;
      }
      .job-card:hover .job-title {
        color: #3498db;
      }
      .company-name {
        font-size: 1.4em;
        color: #7f8c8d;
      }
      .job-details {
        display: flex;
        flex-direction: column;
        margin-bottom: 20px;
      }
      .job-detail {
        margin-bottom: 15px;
        font-size: 1.1em;
        transition: transform 0.3s ease;
      }
      .job-card:hover .job-detail {
        transform: translateX(5px);
      }
      .job-detail span {
        font-weight: 600;
        color: #34495e;
      }
      .job-description {
        line-height: 1.8;
        color: #555;
        margin-bottom: 20px;
        max-height: 150px;
        overflow: hidden;
        transition: max-height 0.5s ease;
      }
      .job-card:hover .job-description {
        max-height: 1000px;
      }
      .apply-link {
        display: inline-block;
        padding: 12px 25px;
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: #fff;
        text-decoration: none;
        border-radius: 30px;
        transition: all 0.3s ease;
        text-align: center;
        font-weight: 600;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
      }
      .apply-link:hover {
        background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
      }
      ul {
        margin: 0;
        padding: 0;
        list-style-type: none;
      }
      ul li {
        margin-bottom: 15px;
        padding-left: 1.8em;
        position: relative;
        transition: transform 0.3s ease;
      }
      ul li:hover {
        transform: translateX(5px);
      }
      ul li::before {
        content: "‚óè";
        position: absolute;
        left: 0;
        color: #3498db;
        font-size: 1.2em;
        line-height: 1;
      }
      .job-select {
        margin-right: 30px;
      }
      .job-select input[type="checkbox"] {
        appearance: none;
        -webkit-appearance: none;
        width: 25px;
        height: 25px;
        border: 2px solid #3498db;
        border-radius: 5px;
        outline: none;
        transition: all 0.3s;
        position: relative;
        cursor: pointer;
      }
      .job-select input[type="checkbox"]:checked {
        background-color: #3498db;
        animation: pulse 0.5s;
      }
      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }
      .job-select input[type="checkbox"]:checked::before {
        content: "‚úî";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 16px;
      }
      .create-persona-btn {
        display: block;
        margin: 40px auto;
        padding: 15px 30px;
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: #fff;
        text-decoration: none;
        border-radius: 30px;
        transition: all 0.3s ease;
        text-align: center;
        width: fit-content;
        font-size: 1.2em;
        font-weight: 600;
        border: none;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        animation: float 3s ease-in-out infinite;
      }
      @keyframes float {
        0% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
        100% {
          transform: translateY(0px);
        }
      }
      .create-persona-btn:hover {
        background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
      }

      #selectAll {
        appearance: none;
        -webkit-appearance: none;
        width: 25px;
        height: 25px;
        border: 2px solid #3498db;
        border-radius: 5px;
        outline: none;
        transition: all 0.3s;
        position: relative;
        cursor: pointer;
      }
      #selectAll:checked {
        background-color: #3498db;
        animation: pulse 0.5s;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }
      .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }
      .select-all-container {
        display: flex;
        align-items: center;
        animation: fadeIn 1s ease-out;
      }

      .select-all-label {
        font-size: 1.1em;
        margin-left: 10px;
        color: #2c3e50;
      }

      #selectAll:checked::before {
        content: "‚úî";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 16px;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }
      .job-description-points {
        max-height: 200px;
        overflow-y: auto;
        padding-right: 10px;
      }

      .description-point {
        display: flex;
        align-items: flex-start;
        margin-bottom: 10px;
        opacity: 0;
        transform: translateY(20px);
        animation: fadeInUp 0.5s ease forwards;
      }

      .point-bullet {
        color: #3498db;
        margin-right: 10px;
        font-size: 1.2em;
      }

      .point-text {
        flex: 1;
      }

      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .job-description-points::-webkit-scrollbar {
        width: 8px;
      }

      .job-description-points::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }

      .job-description-points::-webkit-scrollbar-thumb {
        background: #3498db;
        border-radius: 10px;
      }

      .job-description-points::-webkit-scrollbar-thumb:hover {
        background: #2980b9;
      }
      .point-bullet {
        color: #3498db;
        margin-right: 10px;
        font-size: 1.2em;
        flex-shrink: 0;
      }

      .point-text {
        flex: 1;
      }
      .download-btn {
        padding: 15px 30px;
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: #fff;
        text-decoration: none;
        border-radius: 30px;
        transition: all 0.3s ease;
        text-align: center;
        font-size: 1.2em;
        font-weight: 600;
        border: none;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        animation: float 3s ease-in-out infinite;
      }
      .download-container {
        display: flex;
        justify-content: flex-end;
      }

      .download-btn:hover {
        background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
      }
      .selected-count {
        font-size: 2em;
        text-align: center;
        margin-bottom: 20px;
        color: #3498db;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        animation: pulse 1.5s infinite alternate;
      }

      @keyframes pulse {
        from {
          transform: scale(1);
        }
        to {
          transform: scale(1.1);
        }
      }

      .selected-count.party {
        animation: party 0.5s ease-in-out;
      }

      @keyframes party {
        0% {
          transform: rotate(0deg) scale(1);
        }
        25% {
          transform: rotate(-10deg) scale(1.2);
        }
        50% {
          transform: rotate(10deg) scale(1.2);
        }
        75% {
          transform: rotate(-10deg) scale(1.2);
        }
        100% {
          transform: rotate(0deg) scale(1);
        }
      }
      .persona-designation {
        margin-bottom: 20px;
        animation: fadeIn 1s ease-out;
      }

      .persona-designation label {
        display: block;
        font-size: 1.1em;
        margin-bottom: 10px;
        color: #2c3e50;
      }

      .persona-designation input {
        width: 100%;
        padding: 10px;
        border: 2px solid #3498db;
        border-radius: 5px;
        font-size: 1em;
        transition: all 0.3s ease;
        margin-bottom: 10px;
      }

      .persona-designation input:focus {
        outline: none;
        box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
      }

      .designation-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 10px;
      }

      .designation-tag {
        background-color: #3498db;
        color: white;
        padding: 5px 10px;
        border-radius: 15px;
        display: flex;
        align-items: center;
        font-size: 0.9em;
      }

      .designation-tag .remove {
        margin-left: 5px;
        cursor: pointer;
      }

      .default-designations {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }
      .designation-btn {
        background-color: #ecf0f1;
        border: none;
        padding: 5px 10px;
        border-radius: 15px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }
      .designation-btn {
        background-color: #ecf0f1;
        border: none;
        padding: 5px 10px;
        border-radius: 15px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .designation-btn:hover {
        background-color: #bdc3c7;
      }
      .job-apply-link {
        color: #3498db;
        text-decoration: none;
        transition: color 0.3s ease;
        word-break: break-all;
      }

      .job-apply-link:hover {
        color: #2980b9;
        text-decoration: underline;
      }
      .total-count {
        text-align: center;
        font-size: 1.5em;
        margin-bottom: 20px;
        color: #2c3e50;
      }

      @media screen and (max-width: 768px) {
        .content {
          padding: 20px;
          margin: 10px;
        }

        h1 {
          font-size: 2em;
        }

        .job-card {
          flex-direction: column;
          padding: 20px;
        }

        .job-select {
          margin-right: 0;
          margin-bottom: 15px;
        }

        .job-title {
          font-size: 1.5em;
        }

        .company-name {
          font-size: 1.2em;
        }

        .job-detail {
          font-size: 1em;
        }

        .apply-link {
          padding: 10px 20px;
          font-size: 1em;
        }

        .create-persona-btn {
          padding: 12px 25px;
          font-size: 1em;
        }

        .select-all-container {
          flex-direction: column;
          align-items: flex-start;
        }

        .select-all-label {
          margin-left: 0;
          margin-top: 5px;
        }

        .download-btn {
          padding: 12px 25px;
          font-size: 1em;
        }

        .results-header {
          flex-direction: column;
          align-items: flex-start;
        }

        .download-container {
          margin-top: 10px;
        }

        .persona-designation input {
          font-size: 0.9em;
        }

        .designation-btn {
          font-size: 0.9em;
        }

        .selected-count {
          font-size: 1.5em;
        }

        .total-count {
          font-size: 1.2em;
        }
      }
      .filter-container {
        margin-right: 15px;
      }

      .company-filter {
        padding: 10px 15px;
        border: 2px solid #3498db;
        border-radius: 30px;
        background-color: white;
        color: #2c3e50;
        font-size: 1em;
        cursor: pointer;
        transition: all 0.3s ease;
        outline: none;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-image: url('data:image/svg+xml;utf8,<svg fill="%233498db" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');
        background-repeat: no-repeat;
        background-position: right 10px top 50%;
        padding-right: 30px;
      }

      .company-filter:hover,
      .company-filter:focus {
        border-color: #2980b9;
        box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
      }

      .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      @media screen and (max-width: 768px) {
        .results-header {
          flex-direction: column;
          align-items: stretch;
        }

        .filter-container,
        .download-container {
          width: 100%;
          margin-bottom: 10px;
        }

        .company-filter,
        .download-btn {
          width: 100%;
        }
      }
      .employee-size-container {
        margin-bottom: 25px;
        background: linear-gradient(145deg, #f0f4f8, #e6e9ec);
        border-radius: 15px;
        padding: 15px;
        box-shadow: 5px 5px 15px #d1d9e6, -5px -5px 15px #ffffff;
      }

      .select-label {
        font-size: 14px;
        font-weight: 600;
        color: #3498db;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .select-wrapper {
        position: relative;
        display: inline-block;
        width: 100%;
      }

      .select-wrapper::after {
        content: "\25BC";
        position: absolute;
        top: 50%;
        right: 15px;
        transform: translateY(-50%);
        font-size: 12px;
        color: #3498db;
        pointer-events: none;
        transition: transform 0.3s ease;
      }

      #employeeSize {
        appearance: none;
        -webkit-appearance: none;
        width: 100%;
        padding: 12px 40px 12px 15px;
        font-size: 16px;
        font-weight: 500;
        color: #2c3e50;
        background-color: #ffffff;
        border: 2px solid #3498db;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      #employeeSize:hover {
        background-color: #f8f9fa;
      }

      #employeeSize:focus {
        outline: none;
        border-color: #2980b9;
        box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.3);
      }

      #employeeSize option {
        color: #2c3e50;
        background-color: #ffffff;
      }

      #employeeSize option:first-child {
        color: #7f8c8d;
      }

      @media screen and (min-width: 768px) {
        .employee-size-container {
          display: inline-block;
          vertical-align: top;
          margin-right: 20px;
          width: calc(33.33% - 20px);
        }
      }

      .select-wrapper:hover::after {
        transform: translateY(-50%) rotate(180deg);
      }
      .company-filter {
        position: relative;
        width: 250px;
        font-family: "Poppins", sans-serif;
      }

      .filter-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 20px;
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: #fff;
        border-radius: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11),
          0 1px 3px rgba(0, 0, 0, 0.08);
      }

      .filter-header:hover {
        background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
        transform: translateY(-2px);
        box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1),
          0 3px 6px rgba(0, 0, 0, 0.08);
      }

      .filter-header i {
        transition: transform 0.3s ease;
      }

      .company-filter.active .filter-header i {
        transform: rotate(180deg);
      }

      .company-options {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background-color: #fff;
        border-radius: 15px;
        margin-top: 10px;
        max-height: 300px;
        overflow-y: auto;
        z-index: 1000;
        box-shadow: 0 15px 35px rgba(50, 50, 93, 0.1),
          0 5px 15px rgba(0, 0, 0, 0.07);
        transition: all 0.3s ease;
        opacity: 0;
        transform: translateY(-10px);
      }

      .company-filter.active .company-options {
        display: block;
        opacity: 1;
        transform: translateY(0);
      }

      .option-item {
        display: flex;
        align-items: center;
        padding: 12px 20px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .option-item:hover {
        background-color: #f8f9fa;
      }

      .option-item input[type="checkbox"] {
        margin-right: 10px;
        appearance: none;
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        border: 2px solid #3498db;
        border-radius: 4px;
        outline: none;
        transition: all 0.3s ease;
        position: relative;
        cursor: pointer;
      }

      .option-item input[type="checkbox"]:checked {
        background-color: #3498db;
        border-color: #3498db;
      }

      .option-item input[type="checkbox"]:checked::before {
        content: "‚úî";
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: white;
        font-size: 12px;
      }

      .company-options::-webkit-scrollbar {
        width: 8px;
      }

      .company-options::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }

      .company-options::-webkit-scrollbar-thumb {
        background: #3498db;
        border-radius: 10px;
      }

      .company-options::-webkit-scrollbar-thumb:hover {
        background: #2980b9;
      }
      .source-filter {
        position: relative;
        width: 250px;
        font-family: "Poppins", sans-serif;
        margin-left: 15px;
      }

      .source-filter .filter-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 20px;
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: #fff;
        border-radius: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11),
          0 1px 3px rgba(0, 0, 0, 0.08);
      }

      .source-filter .filter-header:hover {
        background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
        transform: translateY(-2px);
        box-shadow: 0 7px 14px rgba(50, 50, 93, 0.1),
          0 3px 6px rgba(0, 0, 0, 0.08);
      }

      .source-filter.active .filter-header i {
        transform: rotate(180deg);
      }

      .source-options {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background-color: #fff;
        border-radius: 15px;
        margin-top: 10px;
        max-height: 300px;
        overflow-y: auto;
        z-index: 1000;
        box-shadow: 0 15px 35px rgba(50, 50, 93, 0.1),
          0 5px 15px rgba(0, 0, 0, 0.07);
        transition: all 0.3s ease;
        opacity: 0;
        transform: translateY(-10px);
      }

      .source-filter.active .source-options {
        display: block;
        opacity: 1;
        transform: translateY(0);
      }
      .multi-select-wrapper {
        position: relative;
        width: 100%;
      }

      .multi-select-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 15px;
        background-color: #ffffff;
        border: 2px solid #3498db;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .multi-select-header:hover {
        background-color: #f8f9fa;
      }

      .multi-select-header i {
        transition: transform 0.3s ease;
      }

      .multi-select-wrapper.active .multi-select-header i {
        transform: rotate(180deg);
      }

      .multi-select-options {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background-color: #ffffff;
        border: 2px solid #3498db;
        border-top: none;
        border-radius: 0 0 10px 10px;
        max-height: 200px;
        overflow-y: auto;
        z-index: 1000;
      }

      .multi-select-wrapper.active .multi-select-options {
        display: block;
      }

      .multi-select-options label {
        display: block;
        padding: 8px 15px;
        cursor: pointer;
      }

      .multi-select-options label:hover {
        background-color: #f8f9fa;
      }

      .multi-select-options input[type="checkbox"] {
        margin-right: 10px;
      }
      .floating-btn {
        position: fixed;
        bottom: 30px;
        right: 30px;
        display: inline-block;
        padding: 15px 30px;
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: #fff;
        text-decoration: none;
        border-radius: 30px;
        transition: all 0.3s ease;
        text-align: center;
        font-size: 1.2em;
        font-weight: 600;
        border: none;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        z-index: 1000;
      }
      .floating-btn:hover {
        background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
      }
      .floating-btn {
        position: fixed;
        bottom: 30px;
        right: 30px;
        display: inline-block;
        padding: 15px 30px;
        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        color: #fff;
        text-decoration: none;
        border-radius: 30px;
        transition: all 0.3s ease;
        text-align: center;
        font-size: 1.2em;
        font-weight: 600;
        border: none;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        z-index: 1000;
      }

      .floating-btn:hover {
        background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
      }

      .floating-btn.at-bottom {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
      }

      .floating-btn.at-bottom:hover {
        background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
      }
      .ai-summary {
        position: relative;
        background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
        clip-path: polygon(0 0, 100% 0, 97% 100%, 3% 100%);
        padding: 25px 40px 60px;
        margin: 40px 0;
        color: #e0e0e0;
        font-family: "Poppins", sans-serif;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        overflow: hidden;
      }

      .ai-summary-inner {
        position: relative;
        z-index: 2;
        background: rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: 10px;
        backdrop-filter: blur(5px);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        border: 1px solid rgba(255, 255, 255, 0.18);
      }

      .ai-summary h3 {
        font-size: 1.6em;
        margin-bottom: 20px;
        text-transform: uppercase;
        letter-spacing: 2px;
        display: flex;
        align-items: center;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .ai-summary h3::before {
        content: "üí°";
        margin-right: 15px;
        font-size: 1.4em;
      }

      .ai-summary p {
        font-size: 1.2em;
        line-height: 1.7;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
      }

      .wire-container {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 40px;
        overflow: hidden;
      }

      .wire {
        fill: none;
        stroke: #4df0ff;
        stroke-width: 2;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-dasharray: 10, 10;
        stroke-dashoffset: 0;
        animation: flow 1s linear infinite;
      }

      @keyframes flow {
        to {
          stroke-dashoffset: -20;
        }
      }

      .water-level {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 20px;
        background: linear-gradient(to top, #4df0ff, transparent);
        animation: drain 5s ease-in-out infinite;
      }

      @keyframes drain {
        0%,
        100% {
          height: 20px;
          opacity: 0.7;
        }
        50% {
          height: 10px;
          opacity: 0.3;
        }
      }

      .bulb {
        position: absolute;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        background: #ffeb3b;
        box-shadow: 0 0 20px #ffeb3b;
        animation: glow 2s ease-in-out infinite;
      }

      .bulb-left {
        left: 20px;
        bottom: 40px;
      }

      .bulb-right {
        right: 20px;
        bottom: 40px;
      }

      @keyframes glow {
        0%,
        100% {
          opacity: 0.5;
          box-shadow: 0 0 20px #ffeb3b;
        }
        50% {
          opacity: 1;
          box-shadow: 0 0 40px #ffeb3b, 0 0 60px #ffeb3b;
        }
      }
      .company-info {
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
      }

      .ai-industry-tag {
        background-color: #3498db;
        color: white;
        font-size: 0.8em;
        padding: 3px 8px;
        border-radius: 12px;
        display: inline-block;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 2px 4px rgba(52, 152, 219, 0.2);
        transition: all 0.3s ease;
      }

      .ai-industry-tag:hover {
        background-color: #2980b9;
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(52, 152, 219, 0.3);
      }

      /* New styles for improved alignment */
      .form-group {
        margin-bottom: 25px;
      }

      .multi-select-wrapper {
        width: 100%;
        max-width: 500px;
      }

      .select-label {
        text-align: left;
        margin-bottom: 10px;
        font-weight: 600;
        font-size: 1.1em;
      }

      #personaDesignations {
        width: 100%;
        max-width: 500px;
      }

      .default-designations {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 10px;
      }

      .multi-select-header,
      #personaDesignations,
      .designation-btn {
        border-radius: 8px;
      }

      @media (max-width: 768px) {
        .multi-select-wrapper,
        #personaDesignations {
          max-width: 100%;
        }
      }
      .multi-select-wrapper,
      .persona-designation input,
      .default-designations {
        width: 100%;
        max-width: 100%;
      }
      @media screen and (min-width: 768px) {
        .form-group {
          display: flex;
          flex-wrap: wrap;
          justify-content: space-between;
        }

        .multi-select-wrapper,
        .persona-designation {
          width: 48%;
        }

        .employee-size-container {
          width: 100%;
        }
      }
      .persona-designation input {
        width: 100%;
        box-sizing: border-box;
      }

      .default-designations {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        width: 100%;
      }

      .designation-btn {
        flex-grow: 1;
      }
      .content {
        max-width: 1200px;
        width: 95%;
        margin: 20px auto;
        padding: 40px;
      }
      .employee-size-container {
        margin-bottom: 25px;
        width: 100%;
        background: none;
        box-shadow: none;
        padding: 0;
      }

      .employee-size-container .multi-select-wrapper {
        width: 100%;
      }
      .form-group {
        margin-bottom: 25px;
        width: 100%;
      }

      .multi-select-wrapper {
        width: 100%;
      }

      .select-label {
        font-size: 14px;
        font-weight: 600;
        color: #3498db;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .multi-select-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 15px;
        background-color: #ffffff;
        border: 2px solid #3498db;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      @media screen and (min-width: 768px) {
        .form-group,
        .employee-size-container,
        .persona-designation {
          width: 100%;
        }
      }
      .pagination {
        display: flex;
        justify-content: center;
        margin-top: 20px;
        margin-bottom: 20px;
      }

      .pagination-btn {
        padding: 8px 16px;
        margin: 0 4px;
        border: 1px solid #3498db;
        color: #3498db;
        text-decoration: none;
        border-radius: 4px;
        transition: background-color 0.3s, color 0.3s;
      }

      .pagination-btn:hover:not(.active) {
        background-color: #3498db;
        color: white;
      }

      .pagination-btn.active {
        background-color: #3498db;
        color: white;
        cursor: default;
      }
    </style>
  </head>
  <body>
    <a href="#" class="floating-btn" id="scrollToBottomBtn">Scroll to Bottom</a>
    <div id="selected-count" class="selected-count">0 Jobs Selected</div>
    <div class="parallax-container">
      <div class="parallax-layer parallax-background"></div>
      <div class="parallax-layer content">
        <h1>Job Search Results</h1>
        <div id="total-count" class="total-count">
          Total Jobs: <%= jobs.length %>
        </div>
        <div class="results-header">
          <div class="select-all-container">
            <input type="checkbox" id="selectAll" />
            <label for="selectAll" class="select-all-label">Select All</label>
          </div>
          <div class="filter-container">
            <div class="company-filter">
              <div class="filter-header">
                <span>Filter by Company</span>
                <i class="fas fa-chevron-down"></i>
              </div>
              <div class="company-options">
                <label class="option-item"
                  ><input type="checkbox" value="" checked /> All
                  Companies</label
                >
                <% const companies = [...new Set(jobs.map(job =>
                job.employer_name))]; %> <% companies.forEach(company => { %>
                <label class="option-item"
                  ><input type="checkbox" value="<%= company %>" /> <%= company
                  %></label
                >
                <% }); %>
              </div>
            </div>
          </div>
          <div class="filter-container">
            <div class="source-filter">
              <div class="filter-header">
                <span>Filter by Source</span>
                <i class="fas fa-chevron-down"></i>
              </div>
              <div class="source-options">
                <label class="option-item"
                  ><input type="checkbox" value="" checked /> All Sources</label
                >
                <label class="option-item"
                  ><input type="checkbox" value="linkedin" /> LinkedIn</label
                >
                <label class="option-item"
                  ><input type="checkbox" value="indeed" /> Indeed</label
                >
                <label class="option-item"
                  ><input type="checkbox" value="ycombinator" /> Y
                  Combinator</label
                >
                <label class="option-item"
                  ><input type="checkbox" value="glassdoor" /> Glassdoor</label
                >
                <label class="option-item"
                  ><input type="checkbox" value="other" /> Other</label
                >
              </div>
            </div>
          </div>
          <button class="download-btn" onclick="downloadCSV()">Download</button>
        </div>
        <form id="jobForm" action="/create-persona" method="POST">
          <input
            checked
            type="checkbox"
            name="reqId"
            value="<%= reqId%>"
            hidden
          />
          <div class="form-group job-function-container">
            <div class="select-label">Job Function for Persona</div>
            <div class="multi-select-wrapper job-function-select">
              <div class="multi-select-header">
                <span>Select job functions</span>
                <i class="fas fa-chevron-down"></i>
              </div>
              <div class="multi-select-options">
                <% jobFunctionArr.forEach(function(role) { %>
                <label>
                  <input
                    type="checkbox"
                    name="jobFunction"
                    value="<%= role.value %>"
                  />
                  <%= role.label %>
                </label>
                <% }); %>
              </div>
            </div>
          </div>

          <div class="form-group industry-container">
            <div class="select-label">Industry for Persona</div>
            <div class="multi-select-wrapper industry-select">
              <div class="multi-select-header">
                <span>Select industries</span>
                <i class="fas fa-chevron-down"></i>
              </div>
              <div class="multi-select-options">
                <% industryArr.forEach(function(industry) { %>
                <label>
                  <input
                    type="checkbox"
                    name="industry"
                    value="<%= industry.value %>"
                  />
                  <%= industry.label %>
                </label>
                <% }); %>
              </div>
            </div>
          </div>
          <div class="form-group employee-size-container">
            <div class="select-label">Company Size for Persona</div>
            <div class="multi-select-wrapper">
              <div class="multi-select-header">
                <span>Select size ranges</span>
                <i class="fas fa-chevron-down"></i>
              </div>
              <div class="multi-select-options">
                <label
                  ><input type="checkbox" name="employeeSize" value="1,10" />
                  1-10 employees</label
                >
                <label
                  ><input type="checkbox" name="employeeSize" value="11,50" />
                  11-50 employees</label
                >
                <label
                  ><input type="checkbox" name="employeeSize" value="51,100" />
                  51-100 employees</label
                >
                <label
                  ><input type="checkbox" name="employeeSize" value="101,200" />
                  101-200 employees</label
                >
                <label
                  ><input type="checkbox" name="employeeSize" value="201,500" />
                  201-500 employees</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="employeeSize"
                    value="501,1000"
                  />
                  501-1000 employees</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="employeeSize"
                    value="1001,5000"
                  />
                  1001-5000 employees</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="employeeSize"
                    value="5001,10000"
                  />
                  5001-10000 employees</label
                >
                <label
                  ><input type="checkbox" name="employeeSize" value="10001," />
                  10001+ employees</label
                >
              </div>
            </div>
          </div>
          <div class="form-group seniority-level-container">
            <div class="select-label">Seniority Level for Persona</div>
            <div class="multi-select-wrapper seniority-select">
              <div class="multi-select-header">
                <span>Select seniority levels</span>
                <i class="fas fa-chevron-down"></i>
              </div>
              <div class="multi-select-options">
                <label
                  ><input type="checkbox" name="seniorityLevel" value="Owner" />
                  Owner</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="seniorityLevel"
                    value="Founder"
                  />
                  Founder</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="seniorityLevel"
                    value="C Suite"
                  />
                  C Suite</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="seniorityLevel"
                    value="Partner"
                  />
                  Partner</label
                >
                <label
                  ><input type="checkbox" name="seniorityLevel" value="VP" />
                  VP</label
                >
                <label
                  ><input type="checkbox" name="seniorityLevel" value="Head" />
                  Head</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="seniorityLevel"
                    value="Director"
                  />
                  Director</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="seniorityLevel"
                    value="Manager"
                  />
                  Manager</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="seniorityLevel"
                    value="Senior"
                  />
                  Senior</label
                >
                <label
                  ><input type="checkbox" name="seniorityLevel" value="Entry" />
                  Entry</label
                >
                <label
                  ><input
                    type="checkbox"
                    name="seniorityLevel"
                    value="Intern"
                  />
                  Intern</label
                >
              </div>
            </div>
          </div>
          <div class="persona-designation">
            <label for="personaDesignations">Persona Designations:</label>
            <input type="text" id="personaDesignations" />
            <div id="designationTags" class="designation-tags"></div>
            <div class="default-designations">
              <button
                type="button"
                class="designation-btn"
                data-designation="Talent Acquisition"
              >
                Talent Acquisition
              </button>
              <button
                type="button"
                class="designation-btn"
                data-designation="VP of Talent Acquisition"
              >
                VP of Talent Acquisition
              </button>
              <button
                type="button"
                class="designation-btn"
                data-designation="Talent Acquisition Director"
              >
                Talent Acquisition Director
              </button>
              <button
                type="button"
                class="designation-btn"
                data-designation="Director of Talent Acquisition"
              >
                Director of Talent Acquisition
              </button>
              <button
                type="button"
                class="designation-btn"
                data-designation="Head of Talent Acquisition"
              >
                Head of Talent Acquisition
              </button>
            </div>
          </div>
          <% if (jobs && jobs.length > 0) { %> <% jobs.forEach(function(job,
          index) { %>
          <div class="job-card">
            <div class="job-select">
              <input
                type="checkbox"
                id="job<%= index %>"
                name="jobSelect"
                value="<%= job._id %>"
              />
            </div>
            <div style="flex-grow: 1">
              <div class="job-header">
                <div>
                  <div class="job-title"><%= job.job_title || 'N/A' %></div>
                  <div class="company-info">
                    <span class="company-name"
                      ><%= job.employer_name || 'N/A' %></span
                    >
                    <% if (job.ai_industry) { %>
                    <span class="ai-industry-tag"><%= job.ai_industry %></span>
                    <% } %>
                  </div>
                </div>
              </div>
              <% if (job.summary && job.summary !== false) { %>
              <div class="ai-summary">
                <div class="ai-summary-inner">
                  <h3>AI Insight</h3>
                  <p><%= job.summary %></p>
                </div>
                <div class="wire-container">
                  <svg width="100%" height="100%" viewBox="0 0 500 40">
                    <path class="wire" d="M0,20 Q125,5 250,20 T500,20" />
                  </svg>
                </div>
                <div class="water-level"></div>
                <div class="bulb bulb-left"></div>
                <div class="bulb bulb-right"></div>
              </div>
              <% } %>
              <div class="job-details">
                <div class="job-detail">
                  <span>Location:</span>
                  <% if (job.job_city || job.job_state || job.job_country) { %>
                  <%= job.job_city || '' %><%= job.job_city && (job.job_state ||
                  job.job_country) ? ', ' : '' %> <%= job.job_state || '' %><%=
                  job.job_state && job.job_country ? ', ' : '' %> <%=
                  job.job_country || '' %> <% } else { %> N/A <% } %>
                </div>
                <div class="job-detail">
                  <span>Type:</span> <%= job.job_employment_type || 'N/A' %>
                </div>
                <div class="job-detail">
                  <span>Posted:</span> <%= job.job_posted_at_datetime_utc ? new
                  Date(job.job_posted_at_datetime_utc).toLocaleDateString() :
                  'N/A' %>
                </div>
                <div class="job-detail">
                  <span>Employer Website:</span>
                  <% if (job.employer_website) { %>
                  <a
                    href="<%= job.employer_website %>"
                    target="_blank"
                    class="employer-website-link"
                    ><%= job.employer_website %></a
                  >
                  <% } else { %> N/A <% } %>
                </div>
                <div class="job-detail">
                  <span>Job Publisher:</span> <%= job.job_publisher || 'N/A' %>
                </div>
                <!-- <div class="job-detail">
                  <span>Salary Range:</span> <%= job.salaryRange || 'N/A' %>
                </div> -->
              </div>
              <!-- <div class="job-detail">
                <span>Industry Type:</span> <%= job.employer_company_type ||
                'N/A' %>
              </div> -->
              <div class="job-detail">
                <span>Job Post Link:</span>
                <% if (job.job_apply_link) { %>
                <a
                  href="<%= job.job_apply_link %>"
                  target="_blank"
                  class="job-apply-link"
                  ><%= job.job_apply_link %></a
                >
                <% } else { %> N/A <% } %>
              </div>
              <div class="job-description">
                <% if (job.job_description.includes('Qualifications:')) { %>
                <h2>Responsibilities/Job Duties:</h2>
                <ul class="scrollable-list">
                  <%
                  job.job_description.split('Qualifications:')[0].trim().split(/[‚Ä¢¬∑]/).forEach(function(duty)
                  { %> <% if (duty.trim() !== '') { %>
                  <li><%= duty.trim() %></li>
                  <% } %> <% }); %>
                </ul>
                <h2>Qualifications:</h2>
                <ul class="scrollable-list">
                  <%
                  job.job_description.split('Qualifications:')[1].trim().split(/[‚Ä¢¬∑]/).forEach(function(qualification)
                  { %> <% if (qualification.trim() !== '') { %>
                  <li><%= qualification.trim() %></li>
                  <% } %> <% }); %>
                </ul>
                <% } else { %>
                <h2>Description:</h2>
                <ul class="job-description-points">
                  <% job.job_description.trim().split(/[‚Ä¢¬∑]/).filter(point =>
                  point.trim() !== '').forEach((point, index) => { %>
                  <li
                    class="description-point"
                    style="animation-delay: <%= index * 0.1 %>s"
                  >
                    <%= point.trim() %>
                  </li>
                  <% }); %>
                </ul>
                <% } %>
              </div>
            </div>
          </div>
          <% }); %> <% } else { %>
          <p>No jobs available.</p>
          <% } %>
          <button
            type="submit"
            id="createPersonaBtn"
            class="create-persona-btn"
          >
            Create Persona
          </button>
        </form>
        <div class="pagination">
          <% if (currentPage > 1) { %>
          <a
            href="/get-jobs/<%= reqId %>?page=<%= currentPage - 1 %>"
            class="pagination-btn"
            >&laquo; Previous</a
          >
          <% } %> <% for(let i = 1; i <= totalPages; i++) { %> <% if (i ===
          currentPage) { %>
          <span class="pagination-btn active"><%= i %></span>
          <% } else { %>
          <a href="/get-jobs/<%= reqId %>?page=<%= i %>" class="pagination-btn"
            ><%= i %></a
          >
          <% } %> <% } %> <% if (currentPage < totalPages) { %>
          <a
            href="/get-jobs/<%= reqId %>?page=<%= currentPage + 1 %>"
            class="pagination-btn"
            >Next &raquo;</a
          >
          <% } %>
        </div>
      </div>
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const selectAllCheckbox = document.getElementById("selectAll");
        const jobCheckboxes = document.querySelectorAll(
          'input[name="jobSelect"]'
        );
        const selectedCountElement = document.getElementById("selected-count");
        const input = document.getElementById("personaDesignations");
        const tagsContainer = document.getElementById("designationTags");
        const defaultBtns = document.querySelectorAll(".designation-btn");
        const form = document.getElementById("jobForm");
        const createPersonaBtn = document.querySelector(".create-persona-btn");
        const companyFilter = document.querySelector(".company-filter");
        const companyFilterHeader =
          companyFilter.querySelector(".filter-header");
        const companyOptions = companyFilter.querySelector(".company-options");
        const companyCheckboxes = companyFilter.querySelectorAll(
          "input[type='checkbox']"
        );
        const allCompaniesCheckbox =
          companyFilter.querySelector("input[value='']");
        const jobCards = document.querySelectorAll(".job-card");
        const totalCountElement = document.getElementById("total-count");
        const sourceFilter = document.querySelector(".source-filter");
        const sourceFilterHeader = sourceFilter.querySelector(".filter-header");
        const sourceOptions = sourceFilter.querySelector(".source-options");
        const sourceCheckboxes = sourceFilter.querySelectorAll(
          "input[type='checkbox']"
        );
        const allSourcesCheckbox =
          sourceFilter.querySelector("input[value='']");

        let designations = [];

        // Create a hidden input for designations
        const hiddenInput = document.createElement("input");
        hiddenInput.type = "hidden";
        hiddenInput.name = "personaDesignations";
        form.appendChild(hiddenInput);

        function updateSelectedCount() {
          const selectedCount = document.querySelectorAll(
            'input[name="jobSelect"]:checked'
          ).length;
          selectedCountElement.textContent = `${selectedCount} Job${
            selectedCount !== 1 ? "s" : ""
          } Selected`;
          selectedCountElement.classList.add("party");
          setTimeout(() => selectedCountElement.classList.remove("party"), 500);
        }

        function updateInput() {
          input.value = designations.join(", ");
          hiddenInput.value = designations.join(", ");
        }

        function addDesignation(designation) {
          if (!designations.includes(designation)) {
            designations.push(designation);
            updateInput();
            renderTags();
          }
        }

        function removeDesignation(designation) {
          designations = designations.filter((d) => d !== designation);
          updateInput();
          renderTags();
        }

        function renderTags() {
          tagsContainer.innerHTML = "";
          designations.forEach((designation) => {
            const tag = document.createElement("span");
            tag.classList.add("designation-tag");
            tag.innerHTML = `
              ${designation}
              <span class="remove" data-designation="${designation}">&times;</span>
            `;
            tagsContainer.appendChild(tag);
          });
        }

        function getJobSource(applyLink) {
          if (applyLink.includes("linkedin.com")) return "linkedin";
          if (applyLink.includes("indeed.com")) return "indeed";
          if (applyLink.includes("ycombinator.com")) return "ycombinator";
          if (applyLink.includes("glassdoor.com")) return "glassdoor";
          return "other";
        }

        function updateJobVisibility() {
          const selectedCompanies = Array.from(companyCheckboxes)
            .filter((checkbox) => checkbox.checked && checkbox.value !== "")
            .map((checkbox) => checkbox.value);

          const selectedSources = Array.from(sourceCheckboxes)
            .filter((checkbox) => checkbox.checked && checkbox.value !== "")
            .map((checkbox) => checkbox.value);

          const allCompaniesSelected =
            allCompaniesCheckbox.checked || selectedCompanies.length === 0;

          let visibleJobCount = 0;

          jobCards.forEach((card) => {
            const companyName = card
              .querySelector(".company-name")
              .textContent.trim();
            const applyLink = card.querySelector(".job-apply-link")?.href || "";
            const jobSource = getJobSource(applyLink);

            const companyMatch =
              allCompaniesSelected || selectedCompanies.includes(companyName);
            const sourceMatch =
              selectedSources.length === 0 ||
              selectedSources.includes(jobSource);

            if (companyMatch && sourceMatch) {
              card.style.display = "flex";
              visibleJobCount++;
            } else {
              card.style.display = "none";
            }
          });

          updateCounts(visibleJobCount);
          updatePagination(visibleJobCount);
        }

        function updateCounts(visibleJobCount) {
          totalCountElement.textContent = `Total Jobs: ${visibleJobCount}`;
          updateSelectedCount();
        }

        function updatePagination(visibleJobCount) {
          const limit = 500; // jobs per page
          const totalPages = Math.ceil(visibleJobCount / limit);
          const currentPage =
            parseInt(new URLSearchParams(window.location.search).get("page")) ||
            1;
          const paginationContainer = document.querySelector(".pagination");
          let paginationHTML = "";

          if (currentPage > 1) {
            paginationHTML += `<a href="?page=${
              currentPage - 1
            }" class="pagination-btn">&laquo; Previous</a>`;
          }

          for (let i = 1; i <= totalPages; i++) {
            if (i === currentPage) {
              paginationHTML += `<span class="pagination-btn active">${i}</span>`;
            } else {
              paginationHTML += `<a href="?page=${i}" class="pagination-btn">${i}</a>`;
            }
          }

          if (currentPage < totalPages) {
            paginationHTML += `<a href="?page=${
              currentPage + 1
            }" class="pagination-btn">Next &raquo;</a>`;
          }

          paginationContainer.innerHTML = paginationHTML;
        }

        selectAllCheckbox.addEventListener("change", function () {
          const isChecked = this.checked;
          jobCheckboxes.forEach((checkbox) => {
            const jobCard = checkbox.closest(".job-card");
            if (window.getComputedStyle(jobCard).display !== "none") {
              checkbox.checked = isChecked;
            }
          });
          updateSelectedCount();
        });

        jobCheckboxes.forEach((checkbox) => {
          checkbox.addEventListener("change", updateSelectedCount);
        });

        input.addEventListener("keydown", function (e) {
          if (e.key === "Enter" || e.key === ",") {
            e.preventDefault();
            const newDesignation = this.value.trim();
            if (newDesignation) {
              addDesignation(newDesignation);
              this.value = "";
            }
          }
        });

        tagsContainer.addEventListener("click", function (e) {
          if (e.target.classList.contains("remove")) {
            const designationToRemove = e.target.dataset.designation;
            removeDesignation(designationToRemove);
          }
        });

        defaultBtns.forEach((btn) => {
          btn.addEventListener("click", function () {
            addDesignation(this.dataset.designation);
            input.value = "";
          });
        });

        companyFilterHeader.addEventListener("click", function () {
          companyFilter.classList.toggle("active");
        });

        allCompaniesCheckbox.addEventListener("change", function () {
          companyCheckboxes.forEach((checkbox) => {
            if (checkbox !== allCompaniesCheckbox) {
              checkbox.checked = !this.checked;
            }
          });
          updateJobVisibility();
        });

        companyCheckboxes.forEach((checkbox) => {
          checkbox.addEventListener("change", function () {
            if (this !== allCompaniesCheckbox) {
              allCompaniesCheckbox.checked = false;
            }
            updateJobVisibility();
          });
        });

        sourceFilterHeader.addEventListener("click", function () {
          sourceFilter.classList.toggle("active");
        });

        allSourcesCheckbox.addEventListener("change", function () {
          sourceCheckboxes.forEach((checkbox) => {
            if (checkbox !== allSourcesCheckbox) {
              checkbox.checked = !this.checked;
            }
          });
          updateJobVisibility();
        });

        sourceCheckboxes.forEach((checkbox) => {
          checkbox.addEventListener("change", function () {
            if (this !== allSourcesCheckbox) {
              allSourcesCheckbox.checked = false;
            }
            updateJobVisibility();
          });
        });

        document.addEventListener("click", function (event) {
          if (!event.target.closest(".company-filter")) {
            companyFilter.classList.remove("active");
          }
          if (!event.target.closest(".source-filter")) {
            sourceFilter.classList.remove("active");
          }
        });

        updateJobVisibility();

        function downloadCSV() {
          const selectedJobs = Array.from(
            document.querySelectorAll('input[name="jobSelect"]:checked')
          )
            .map((checkbox) => {
              const jobCard = checkbox.closest(".job-card");
              if (!jobCard) return null;

              const jobDetails = jobCard.querySelectorAll(".job-detail");
              const locationDetail = Array.from(jobDetails).find((detail) =>
                detail.textContent.includes("Location:")
              );
              const typeDetail = Array.from(jobDetails).find((detail) =>
                detail.textContent.includes("Type:")
              );
              const postedDateDetail = Array.from(jobDetails).find((detail) =>
                detail.textContent.includes("Posted:")
              );
              const industryTypeDetail = Array.from(jobDetails).find((detail) =>
                detail.textContent.includes("Industry Type:")
              );
              const employerWebsiteDetail = Array.from(jobDetails).find(
                (detail) => detail.textContent.includes("Employer Website:")
              );
              const jobPublisherDetail = Array.from(jobDetails).find((detail) =>
                detail.textContent.includes("Job Publisher:")
              );

              const descriptionElement =
                jobCard.querySelector(".job-description");
              let description = "";
              if (descriptionElement) {
                const points = descriptionElement.querySelectorAll("li");
                description = Array.from(points)
                  .map((point) => point.textContent.trim())
                  .join(" | ");
              }

              return {
                job_title:
                  jobCard.querySelector(".job-title").textContent.trim() ||
                  "N/A",
                company_name:
                  jobCard.querySelector(".company-name").textContent.trim() ||
                  "N/A",
                location: locationDetail
                  ? locationDetail.textContent.split("Location:")[1].trim()
                  : "N/A",
                type: typeDetail
                  ? typeDetail.textContent.split("Type:")[1].trim()
                  : "N/A",
                posted_date: postedDateDetail
                  ? postedDateDetail.textContent.split("Posted:")[1].trim()
                  : "N/A",
                industry_type: industryTypeDetail
                  ? industryTypeDetail.textContent
                      .split("Industry Type:")[1]
                      .trim()
                  : "N/A",
                employer_website: employerWebsiteDetail
                  ? employerWebsiteDetail.querySelector("a")?.href || "N/A"
                  : "N/A",
                job_publisher: jobPublisherDetail
                  ? jobPublisherDetail.textContent
                      .split("Job Publisher:")[1]
                      .trim()
                  : "N/A",
                apply_link: jobCard.querySelector(".job-apply-link")
                  ? jobCard.querySelector(".job-apply-link").href
                  : "N/A",
                description: description || "N/A",
              };
            })
            .filter((job) => job !== null);

          if (selectedJobs.length === 0) {
            alert("Please select at least one job to download.");
            return;
          }

          const headers = Object.keys(selectedJobs[0]);
          let csvContent = headers.join(",") + "\n";

          selectedJobs.forEach((job) => {
            const row = headers.map((header) => {
              let cell = job[header] || "";
              cell = cell.replace(/"/g, '""');
              if (
                cell.includes(",") ||
                cell.includes("\n") ||
                cell.includes('"')
              ) {
                cell = `"${cell}"`;
              }
              return cell;
            });
            csvContent += row.join(",") + "\n";
          });

          const blob = new Blob([csvContent], {
            type: "text/csv;charset=utf-8;",
          });
          const link = document.createElement("a");
          if (link.download !== undefined) {
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", "job_data.csv");
            link.style.visibility = "hidden";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
          }
        }
        document
          .querySelector(".download-btn")
          .addEventListener("click", downloadCSV);

        // Employee size multi-select
        const employeeSizeSelect = document.querySelector(
          ".employee-size-container .multi-select-wrapper"
        );
        const employeeSizeHeader = employeeSizeSelect.querySelector(
          ".multi-select-header"
        );
        const employeeSizeOptions = employeeSizeSelect.querySelector(
          ".multi-select-options"
        );
        const employeeSizeCheckboxes = employeeSizeSelect.querySelectorAll(
          'input[name="employeeSize"]'
        );

        employeeSizeHeader.addEventListener("click", function () {
          employeeSizeSelect.classList.toggle("active");
        });

        employeeSizeCheckboxes.forEach((checkbox) => {
          checkbox.addEventListener("change", updateSelectedSizes);
        });

        function updateSelectedSizes() {
          const selectedSizes = Array.from(employeeSizeCheckboxes)
            .filter((checkbox) => checkbox.checked)
            .map((checkbox) => checkbox.parentNode.textContent.trim());

          employeeSizeHeader.querySelector("span").textContent =
            selectedSizes.length > 0
              ? selectedSizes.join(", ")
              : "Select size ranges";
        }

        // Seniority level multi-select
        const senioritySelect = document.querySelector(
          ".seniority-level-container .multi-select-wrapper"
        );
        const seniorityHeader = senioritySelect.querySelector(
          ".multi-select-header"
        );
        const seniorityOptions = senioritySelect.querySelector(
          ".multi-select-options"
        );
        const seniorityLevelCheckboxes = senioritySelect.querySelectorAll(
          'input[name="seniorityLevel"]'
        );

        seniorityHeader.addEventListener("click", function () {
          senioritySelect.classList.toggle("active");
        });

        seniorityLevelCheckboxes.forEach((checkbox) => {
          checkbox.addEventListener("change", updateSelectedSeniorityLevels);
        });

        function updateSelectedSeniorityLevels() {
          const selectedLevels = Array.from(seniorityLevelCheckboxes)
            .filter((checkbox) => checkbox.checked)
            .map((checkbox) => checkbox.parentNode.textContent.trim());

          seniorityHeader.querySelector("span").textContent =
            selectedLevels.length > 0
              ? selectedLevels.join(", ")
              : "Select seniority levels";
        }

        // Job function multi-select
        const jobFunctionSelect = document.querySelector(
          ".job-function-container .multi-select-wrapper"
        );
        const jobFunctionHeader = jobFunctionSelect.querySelector(
          ".multi-select-header"
        );
        const jobFunctionOptions = jobFunctionSelect.querySelector(
          ".multi-select-options"
        );
        const jobFunctionCheckboxes = jobFunctionSelect.querySelectorAll(
          'input[name="jobFunction"]'
        );

        jobFunctionHeader.addEventListener("click", function () {
          jobFunctionSelect.classList.toggle("active");
        });

        jobFunctionCheckboxes.forEach((checkbox) => {
          checkbox.addEventListener("change", updateSelectedJobFunctions);
        });
        function updateSelectedJobFunctions() {
          const selectedFunctions = Array.from(jobFunctionCheckboxes)
            .filter((checkbox) => checkbox.checked)
            .map((checkbox) => checkbox.parentNode.textContent.trim());

          jobFunctionHeader.querySelector("span").textContent =
            selectedFunctions.length > 0
              ? selectedFunctions.join(", ")
              : "Select job functions";
        }

        // Industry multi-select
        const industrySelect = document.querySelector(
          ".industry-container .multi-select-wrapper"
        );
        const industryHeader = industrySelect.querySelector(
          ".multi-select-header"
        );
        const industryOptions = industrySelect.querySelector(
          ".multi-select-options"
        );
        const industryCheckboxes = industrySelect.querySelectorAll(
          'input[name="industry"]'
        );

        industryHeader.addEventListener("click", function () {
          industrySelect.classList.toggle("active");
        });

        industryCheckboxes.forEach((checkbox) => {
          checkbox.addEventListener("change", updateSelectedIndustries);
        });

        function updateSelectedIndustries() {
          const selectedIndustries = Array.from(industryCheckboxes)
            .filter((checkbox) => checkbox.checked)
            .map((checkbox) => checkbox.parentNode.textContent.trim());

          industryHeader.querySelector("span").textContent =
            selectedIndustries.length > 0
              ? selectedIndustries.join(", ")
              : "Select industries";
        }

        // Close dropdowns when clicking outside
        document.addEventListener("click", function (event) {
          if (!employeeSizeSelect.contains(event.target)) {
            employeeSizeSelect.classList.remove("active");
          }
          if (!senioritySelect.contains(event.target)) {
            senioritySelect.classList.remove("active");
          }
          if (!jobFunctionSelect.contains(event.target)) {
            jobFunctionSelect.classList.remove("active");
          }
          if (!industrySelect.contains(event.target)) {
            industrySelect.classList.remove("active");
          }
        });

        // Update form submission to include all selections with label and value
        form.addEventListener("submit", function (event) {
          const selectedJobs = document.querySelectorAll(
            'input[name="jobSelect"]:checked'
          );
          updateInput();

          if (selectedJobs.length === 0) {
            event.preventDefault();
            alert("Please select at least one job before creating a persona.");
          } else if (designations.length === 0) {
            event.preventDefault();
            alert("Please enter at least one Persona Designation.");
          } else {
            const selectedSizes = Array.from(employeeSizeCheckboxes)
              .filter((checkbox) => checkbox.checked)
              .map((checkbox) => checkbox.value);

            const selectedSeniorityLevels = Array.from(seniorityLevelCheckboxes)
              .filter((checkbox) => checkbox.checked)
              .map((checkbox) => checkbox.value);

            const selectedJobFunctions = Array.from(jobFunctionCheckboxes)
              .filter((checkbox) => checkbox.checked)
              .map((checkbox) => {
                return {
                  label: checkbox.parentNode.textContent.trim(),
                  value: checkbox.value,
                };
              });

            const selectedIndustries = Array.from(industryCheckboxes)
              .filter((checkbox) => checkbox.checked)
              .map((checkbox) => {
                return {
                  label: checkbox.parentNode.textContent.trim(),
                  value: checkbox.value,
                };
              });

            const hiddenInput = document.createElement("input");
            hiddenInput.type = "hidden";
            hiddenInput.name = "personaAttributes";
            hiddenInput.value = JSON.stringify({
              employeeSizes: selectedSizes,
              seniorityLevels: selectedSeniorityLevels,
              jobFunctions: selectedJobFunctions,
              industries: selectedIndustries,
            });
            this.appendChild(hiddenInput);

            createPersonaBtn.disabled = true;
            createPersonaBtn.textContent = "Creating Persona...";
            setTimeout(function () {
              createPersonaBtn.disabled = false;
              createPersonaBtn.textContent = "Create Persona";
            }, 85000);
          }
        });

        // Initialize visibility and pagination
        updateJobVisibility();

        // Floating scroll button functionality
        const scrollButton = document.getElementById("scrollToBottomBtn");
        const parallaxContainer = document.querySelector(".parallax-container");

        function updateScrollButton() {
          const scrollPosition = parallaxContainer.scrollTop;
          const maxScroll =
            parallaxContainer.scrollHeight - parallaxContainer.clientHeight;

          if (scrollPosition >= maxScroll - 20) {
            // Within 20px of the bottom
            scrollButton.textContent = "Scroll to Top";
            scrollButton.classList.add("at-bottom");
          } else {
            scrollButton.textContent = "Scroll to Bottom";
            scrollButton.classList.remove("at-bottom");
          }
        }

        scrollButton.addEventListener("click", function (e) {
          e.preventDefault();
          if (this.classList.contains("at-bottom")) {
            parallaxContainer.scrollTo({
              top: 0,
              behavior: "smooth",
            });
          } else {
            parallaxContainer.scrollTo({
              top: parallaxContainer.scrollHeight,
              behavior: "smooth",
            });
          }
        });

        parallaxContainer.addEventListener("scroll", updateScrollButton);

        // Initial update
        updateScrollButton();
      });
    </script>
  </body>
</html>
